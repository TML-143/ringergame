<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#050814" />
    <meta name="color-scheme" content="dark" />
    <meta name="description" content="Ringer Game — a client-only bell ringing practice game." />
    <meta name="application-name" content="Ringer Game" />

    <!-- iOS “Add to Home Screen” support -->
    <meta name="apple-mobile-web-app-title" content="Ringer Game" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <title>Ringer Game</title>

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="./icon-192.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="./icon-180.png" />

    <!-- PWA -->
    <link rel="manifest" href="./manifest.webmanifest" />

    <link rel="stylesheet" href="./app.css" />
  </head>
  <body>
    <div id="app">
      <button id="menuToggle" class="menu-toggle hidden" type="button" aria-label="Menu" title="Menu" aria-controls="rgHamburgerDropdown" aria-expanded="false">
        <span class="menu-toggle-icon" aria-hidden="true"></span>
      </button>
      <div id="rgHamburgerDropdown" class="rg-hamburger-dropdown hidden" aria-hidden="true" role="menu" aria-label="Navigation">
        <button class="rg-hamburger-item" type="button" data-ham="home" role="menuitem">Home</button>
        <button class="rg-hamburger-item" type="button" data-ham="setup" role="menuitem">Setup</button>
        <button class="rg-hamburger-item" type="button" data-ham="view" role="menuitem">View</button>
        <button class="rg-hamburger-item" type="button" data-ham="sound" role="menuitem">Sound</button>
        <button class="rg-hamburger-item" type="button" data-ham="play" role="menuitem">Play</button>
        <button class="rg-hamburger-item" type="button" data-ham="demo" role="menuitem">Demo</button>
      </div>

      <!-- v09_p05_stop_current_run_modal: custom modal to stop an active run before starting Demo from menus -->
      <div id="rgStopRunModal" class="rg-stoprun-modal hidden" aria-hidden="true">
        <div class="rg-stoprun-panel pane" role="dialog" aria-modal="true" aria-label="Stop current game">
          <button id="rgStopRunModalClose" class="rg-stoprun-close" type="button" aria-label="Close">×</button>
          <div class="rg-stoprun-body">
            <div class="rg-stoprun-msg">Stop the current game first.</div>
            <div class="rg-stoprun-actions">
              <button id="rgStopRunModalStop" class="pill" type="button">Stop</button>
            </div>
          </div>
        </div>
      </div>
      <div id="screenHome" class="rg-screen rg-active" aria-hidden="false">
        <section class="pane rg-splash">
          <div class="rg-screen-body">
            <div class="rg-home" aria-label="Home">
              <div class="rg-home-brand" aria-label="Title">
                <div class="rg-home-title">Ringer Game</div>
                <img id="homeBellLogo" class="rg-home-logo" src="bell.png" alt="Bell logo" role="button" tabindex="0" />
              </div>
              <div class="rg-home-menu" aria-label="Home navigation">
                <button id="homeBtnPlay" class="pill" type="button">Setup</button>
                <button id="homeBtnView" class="pill" type="button">View</button>
                <button id="homeBtnSound" class="pill" type="button">Sound</button>
              </div>
              <div class="rg-home-bottom" aria-label="Quick start">
                <button id="homeBtnDemo" class="pill" type="button">Demo</button>
                <button id="homeBtnBegin" class="pill" type="button">Play</button>
              </div>
            </div>
          </div>
        </section>
      </div>

      <div id="screenPlay" class="rg-screen" aria-hidden="true">
        <section class="pane rg-splash">
          <div class="pane-title"><span>Setup</span></div>
          <div class="rg-screen-body">
            <div id="playMenuControls" class="rg-controls" aria-label="Setup controls">
              <div id="setupBlockLibrary" class="rg-setup-block">
                <div class="rg-setup-block-head"><div class="rg-setup-block-title">Library</div></div>
                <div id="setupBlockLibraryBody" class="rg-setup-block-body rg-controls">
                  <div class="control">
                                <label>Local library</label>
                                <button id="setupLoadLibraryLocalBtn" class="pill" type="button">Load library XML/ZIP…</button>
                              </div>
                  <div id="setupCCCBRLibraryControl" class="control">
                                <label>CCCBR Library</label>
                                <a id="setupCCCBRDownloadLink" href="https://methods.cccbr.org.uk/xml/CCCBR_methods.xml.zip" target="_blank" rel="noopener">CCCBR methods library (download ZIP)</a>
                                <button id="setupLoadCCCBRWebBtn" class="pill" type="button">Download &amp; Load CCCBR library</button>
                                <span id="setupLoadCCCBRWebStatus" class="rg-muted"></span>
                              </div>
                  <div class="control rg-setup-library-status">
                                <label>Status</label>
                                <span id="setupLibraryLoadedStatus" class="rg-muted" aria-live="polite">No library loaded.</span>
                              </div>
                  <div class="control rg-setup-library-explore hidden">
                                <button id="setupExploreLibraryBtn" class="pill" type="button" disabled title="Load a CCCBR library XML/ZIP first">Explore library</button>
                              </div>
                </div>
              </div>
              <div id="setupBlockMethod" class="rg-setup-block">
                <div class="rg-setup-block-head"><div class="rg-setup-block-title">Method</div></div>
                <div id="setupBlockMethodBody" class="rg-setup-block-body rg-controls"></div>
              </div>
              <div id="setupBlockTempo" class="rg-setup-block">
                <div class="rg-setup-block-head"><div class="rg-setup-block-title">Tempo</div></div>
                <div id="setupBlockTempoBody" class="rg-setup-block-body rg-controls"></div>
              </div>
              <div id="setupBlockBells" class="rg-setup-block">
                <div class="rg-setup-block-head"><div class="rg-setup-block-title">Bells</div></div>
                <div id="setupBlockBellsBody" class="rg-setup-block-body rg-controls"></div>
              </div>
              <div id="setupBlockMic" class="rg-setup-block">
                <div class="rg-setup-block-head"><div class="rg-setup-block-title">Mic</div></div>
                <div id="setupBlockMicBody" class="rg-setup-block-body rg-controls"></div>
              </div>
            </div>
<div class="rg-nav">
              <button class="pill" type="button" data-go-screen="home">Home</button>
              <button class="pill" type="button" data-go-screen="play">Setup</button>
              <button class="pill" type="button" data-go-screen="view">View</button>
              <button class="pill" type="button" data-go-screen="sound">Sound</button>
              <button id="playBtnEnterGame" class="pill" type="button">Play</button>
              <button id="playBtnDemo" class="pill" type="button">Demo</button>
            </div>
          </div>
        </section>
      </div>

      <div id="screenView" class="rg-screen" aria-hidden="true">
        <section class="pane rg-splash">
          <div class="pane-title"><span>View</span></div>
          <div class="rg-screen-body">
            <div id="viewMenuControls" class="rg-controls" aria-label="View controls">
              <div class="control">
                <label for="layoutPresetSelect">Layout preset</label>
                <select id="layoutPresetSelect">
                  <option value="auto">Auto (recommended)</option>
                  <option value="two_col">Two columns (classic)</option>
                  <option value="one_wide">One column (wide)</option>
                  <option value="one_narrow">One column (narrow / centered)</option>
                  <option value="mobile_thumb">Mobile (thumb reach)</option>
                </select>
                <div class="control-note rg-muted">Controls layout only; window toggles still control what is shown.</div>
              </div>

              <div class="control">
                <label for="notationLayoutSelect">Notation layout</label>
                <select id="notationLayoutSelect">
                  <option value="two_page">Two-page spread</option>
                  <option value="one_page">Single page (touch)</option>
                </select>
              </div>


            </div>
            <div class="rg-nav">
              <button class="pill" type="button" data-go-screen="home">Home</button>
              <button class="pill" type="button" data-go-screen="play">Setup</button>
              <button class="pill" type="button" data-go-screen="view">View</button>
              <button class="pill" type="button" data-go-screen="sound">Sound</button>
              <button id="viewBtnEnterGame" class="pill" type="button">Play</button>
              <button id="viewBtnDemo" class="pill" type="button">Demo</button>
            </div>
          </div>
        </section>
      </div>

      
      <div id="screenPrivacy" class="rg-screen" aria-hidden="true">
        <section class="pane rg-splash">
          <div class="pane-title"><span>Privacy</span></div>
          <div class="rg-screen-body">
            
            <div class="rg-privacy-consent">
              <div class="control rg-privacy-consent-control">
                <div class="toggles toggles--mini" role="group" aria-label="Privacy toggles">
                  <label class="toggle"><input id="privacyAudienceCheckbox" type="checkbox" /> Audience measurement</label>
                </div>
                <div class="control-note rg-muted">Optional. Counts site visits and page/screen views only.<br />No user profiles, no cross-visit tracking, no gameplay data.</div>
                <div id="privacyRefreshNotice" class="rg-privacy-refresh-note hidden" aria-hidden="true">Audience measurement disabled. To ensure analytics is not loaded at all, please refresh the page.</div>
              </div>
            </div>

            <div id="privacyPolicyPre" class="rg-privacy-policy" aria-label="Privacy policy">
              <h2>Privacy &amp; Analytics</h2>
              <p><strong>Ringer Game is a client-only web app.</strong></p>

              <h3>What Ringer Game does not do</h3>
              <ul>
                <li>It does not create user profiles.</li>
                <li>It does not assign persistent user IDs.</li>
                <li>It does not track you across visits.</li>
                <li>It does not record or transmit gameplay actions, scores, or timing data.</li>
              </ul>

              <h3>Audience measurement (optional)</h3>
              <p>If you enable Audience measurement, Ringer Game uses Google Analytics 4 to measure overall site usage, such as page or screen views, approximate location at the country or region level, and coarse device or browser information.</p>
              <p>This information is used only to understand audience size and general usage trends.</p>
              <p>Ringer Game does not send gameplay events, scores, timing metrics, bell-by-bell data, or other run details to Google Analytics.</p>

              <h3>Local gameplay data</h3>
              <p>Gameplay statistics and preferences may be stored in your browser (for example, via localStorage) so the game can remember settings and show your performance stats. This data stays on your device.</p>

              <h3>Your choice</h3>
              <p>Audience measurement is off by default. You can enable or disable it at any time from the Privacy page.</p>
              <p>When Audience measurement is turned off, analytics is stopped immediately. A page refresh ensures it is not loaded at all.</p>

              <h3>CCCBR method library (optional)</h3>
              <p>From Setup, you can optionally choose to download a method library from CCCBR. If you choose it, your browser will request data from CCCBR-hosted resources.</p>
              <p>CCCBR is a third party; their handling of data is governed by their terms. Ringer Game does not claim ownership of CCCBR content. See: <a href="https://www.cccbr.org.uk/" target="_blank" rel="noopener">https://www.cccbr.org.uk/</a></p>

              <h3>Third party</h3>
              <p>Google Analytics is provided by Google. Their processing of data is governed by Google’s own privacy terms.</p>

              <p>Contact: <a href="mailto:ringergame143@gmail.com">ringergame143@gmail.com</a></p>
            </div>
            <div class="rg-nav">
              <button class="pill" type="button" data-go-screen="home">Home</button>
              <button class="pill" type="button" data-go-screen="game">Play</button>
              <button id="privacyBtnDemo" class="pill" type="button">Demo</button>
            </div>
          </div>
        </section>
      </div>

<div id="screenSound" class="rg-screen" aria-hidden="true">
        <section class="pane rg-splash">
          <div class="pane-title"><span>Sound</span></div>
          <div class="rg-screen-body">
            <!-- v011_p03_sound_layout_drone_first: DRONE block (moved above pitch + sound) -->
            <div id="soundDroneBlock" class="rg-sound-block" aria-label="Drone">
              <div class="rg-sound-block-head">
                <div class="rg-sound-block-title">DRONE LAYERS</div>
              </div>
              <div id="soundDroneControls" class="rg-controls" aria-label="Drone controls"></div>
            </div>

                        <!-- v011_p03_sound_layout_drone_first: BELL SOUND block (existing sound controls) -->
            <div id="soundBellSoundBlock" class="rg-sound-block" aria-label="Bell sound">
              <div class="rg-sound-block-head">
                <div class="rg-sound-block-title">BELL SOUND</div>
              </div>

              <div id="soundMenuControls" class="rg-controls" aria-label="Sound controls"></div>

              <!-- v10_p08_sound_global_chords_splitstrike: global chord controls -->
              <div id="soundChordControls" class="rg-controls rg-sound-chords" aria-label="Chord controls">
                <div class="control">
                  <label>Chords</label>
                  <button id="globalChordOnOffBtn" class="pill" type="button" aria-pressed="false">Chords (global) Off</button>
                  <div class="control-note rg-muted">Applies to all bell strikes.</div>
                </div>
                <div class="control">
                  <label for="globalChordPresetSelect">Chord preset</label>
                  <select id="globalChordPresetSelect"></select>
                </div>
                <div id="globalChordCustomIntervalsControl" class="control hidden">
                  <label for="globalChordCustomIntervalsInput">Intervals</label>
                  <input id="globalChordCustomIntervalsInput" type="text" placeholder="0, 4, 7, 12" />
                  <div class="control-note rg-muted">Semitone offsets from the struck note.</div>
                  <div id="globalChordCustomIntervalsWarn" class="rg-inline-warn hidden"></div>
                </div>
                <div class="control">
                  <label for="globalChordSplitSelect">Split-strike</label>
                  <select id="globalChordSplitSelect"></select>
                </div>
                <div class="control">
                  <label for="globalChordInversionSelect">Inversion</label>
                  <select id="globalChordInversionSelect"></select>
                </div>
                <div class="control">
                  <label for="globalChordSpreadSelect">Spread</label>
                  <select id="globalChordSpreadSelect"></select>
                </div>
                <div id="globalChordSplitStepControl" class="control hidden">
                  <label for="globalChordStepMs">Step (ms)</label>
                  <input id="globalChordStepMs" type="number" min="0" max="15" step="1" value="6" />
                </div>
                <div id="globalChordSplitMaxControl" class="control hidden">
                  <label for="globalChordMaxMs">Max (ms)</label>
                  <input id="globalChordMaxMs" type="number" min="0" max="18" step="1" value="12" />
                  <details id="globalChordAdvancedDetails" class="rg-chords-advanced">
                  <summary>Advanced</summary>
                  <div class="rg-chords-advanced-body">
                    <div class="control">
                      <label for="globalChordDetuneCents">Global Detune (cents): <span id="globalChordDetuneCentsValue">0</span></label>
                      <input id="globalChordDetuneCents" type="range" min="-20" max="20" step="1" value="0" />
                    </div>

                    <div class="control">
                      <label for="globalChordLevelModeSelect">Global Voice Levels</label>
                      <select id="globalChordLevelModeSelect">
                        <option value="equal">Equal</option>
                        <option value="custom">Custom</option>
                      </select>
                    </div>
                    <div id="globalChordLevelGainsControl" class="control hidden">
                      <label for="globalChordLevelGainsInput">Voice level gains</label>
                      <input id="globalChordLevelGainsInput" type="text" placeholder="1, 0.8, 0.7" />
                      <div class="control-note rg-muted">Per-voice gain multipliers (≥ 0). Missing values default to 1.</div>
                    </div>

                    <div class="control">
                      <label for="globalChordSplitOffsetModeSelect">Global Split Offsets (ms)</label>
                      <select id="globalChordSplitOffsetModeSelect">
                        <option value="auto">Auto</option>
                        <option value="custom">Custom</option>
                      </select>
                    </div>
                    <div id="globalChordSplitOffsetsControl" class="control hidden">
                      <label for="globalChordSplitOffsetsInput">Split offsets (ms)</label>
                      <input id="globalChordSplitOffsetsInput" type="text" placeholder="0, 25, 45" />
                      <div class="control-note rg-muted">Per-voice strike delays (ms, ≥ 0). Only used in Bell-like split-strike.</div>
                    </div>
                  </div>
                </details>
              </div>
              </div>

              <!-- v014_p05a_bell_timbre_global: global Bell Timbre controls (bells only) -->
              <div class="rg-sound-subsection-title">BELL TIMBRE</div>
              <div id="soundBellTimbreControls" class="rg-controls rg-sound-bell-timbre" aria-label="Bell timbre">
                <div class="control">
                  <label for="bellRingLength">Ring Length: <span id="bellRingLengthValue">0.50</span></label>
                  <input id="bellRingLength" type="range" min="0" max="1" step="0.01" value="0.50" />
                </div>
                <div class="control">
                  <label for="bellBrightness">Brightness: <span id="bellBrightnessValue">0.50</span></label>
                  <input id="bellBrightness" type="range" min="0" max="1" step="0.01" value="0.50" />
                </div>
                <div class="control">
                  <label for="bellStrikeHardness">Strike Hardness: <span id="bellStrikeHardnessValue">0.00</span></label>
                  <input id="bellStrikeHardness" type="range" min="0" max="1" step="0.01" value="0" />
                </div>
              </div>

              <div id="bellOverridesControl" class="control rg-bell-overrides-control" aria-label="Per-bell sound">
                <label>Per-bell sound</label>
                <div class="rg-bell-overrides-actions">
                  <div id="soundQuickBellRow" class="rg-quick-bell-row" aria-label="Quick bell row"></div>
                  <button id="bellOverridesResetBtn" class="pill" type="button">Reset all per-bell overrides</button>
                </div>
                <div id="bellOverridesList" class="rg-bell-overrides-list" aria-label="Per-bell overrides list"></div>
                <div class="control-note rg-muted">Overrides layer on top of Bell key/register and Bell volume.</div>
              </div>
            </div><!-- v011_p02_sound_test_instrument_row: Bell Test Instrument Row (tap + drag-to-ring) -->
            <div id="soundTestInstrumentRow" class="rg-sound-test-row rg-quick-bell-row" aria-label="Bell test instrument"></div>

            <!-- v011_p04_bell_pitch_collapsible_blocks: BELL PITCH block (collapsed-by-default) -->
            <details id="soundPitchBlock" class="rg-sound-block rg-sound-block--collapsible" aria-label="Bell pitch">
              <summary class="rg-sound-block-summaryline" aria-controls="soundPitchControls">
                <span class="rg-sound-block-title">Bell Pitch</span>
                <span id="soundPitchSummary" class="rg-sound-block-summary rg-muted">Diatonic — F♯ Major — Compact</span>
                <span class="rg-sound-block-caret" aria-hidden="true"></span>
              </summary>
              <div id="soundPitchControls" class="rg-controls" aria-label="Bell pitch controls"></div>
            </details>

            
            
<div id="soundMasterFxBlock" class="rg-sound-block" aria-label="Master / Output">
  <div class="rg-sound-block-head">
    <div class="rg-sound-block-title">Master / Output</div>
  </div>
  <div id="soundMasterFxControls" class="rg-controls rg-sound-masterfx" aria-label="Master FX controls">
    <div class="control">
      <label>Limiter</label>
      <button id="masterLimiterToggle" class="pill" type="button" aria-pressed="true">Limiter On</button>
      <div class="control-note rg-muted">Protects against clipping when stacking chords + drone.</div>
    </div>
    <div class="control">
      <label for="masterLimiterStrength">Strength</label>
      <input id="masterLimiterStrength" type="range" min="0" max="1" step="0.01" value="0.25" />
    </div>
    <div class="control">
      <label>Reverb</label>
      <button id="masterReverbToggle" class="pill" type="button" aria-pressed="false">Reverb Off</button>
      <div class="control-note rg-muted">Send-style ambience (dry stays clear).</div>
    </div>
    <div class="control">
      <label for="masterReverbSize">Room size</label>
      <input id="masterReverbSize" type="range" min="0" max="1" step="0.01" value="0.55" />
    </div>
    <div class="control">
      <label for="masterReverbMix">Mix</label>
      <input id="masterReverbMix" type="range" min="0" max="1" step="0.01" value="0.15" />
    </div>
    <div class="control">
      <label for="spatialDepthModeSelect">Depth curve</label>
      <select id="spatialDepthModeSelect">
        <option value="subtle">Subtle</option>
        <option value="normal" selected>Normal</option>
        <option value="strong">Strong</option>
      </select>
      <div class="control-note rg-muted">Scales Depth strength (dry, filter, reverb send).</div>
    </div>
    <div class="control">
      <label for="masterReverbHighCut">High-cut (Hz)</label>
      <input id="masterReverbHighCut" type="range" min="500" max="20000" step="100" value="6000" />
    </div>
  </div>
</div>
<div class="rg-nav">
              <button class="pill" type="button" data-go-screen="home">Home</button>
              <button class="pill" type="button" data-go-screen="play">Setup</button>
              <button class="pill" type="button" data-go-screen="view">View</button>
              <button class="pill" type="button" data-go-screen="sound">Sound</button>
              <button id="soundBtnEnterGame" class="pill" type="button">Play</button>
              <button id="soundBtnDemo" class="pill" type="button">Demo</button>
            </div>
          </div>
        </section>
      </div>

      

      <div id="screenLibrary" class="rg-screen" aria-hidden="true">
        <section class="pane rg-splash">
          <div class="pane-title"><span>Method Library</span></div>
          <div class="rg-screen-body">
            <div class="rg-muted rg-library-loaded">Loaded library: <span id="libraryFileName">none</span></div>

            <div id="libraryJumpRow" class="rg-library-jump-row hidden" aria-label="Jump">
              <button id="libraryJumpDetailsBtn" class="pill rg-library-jump-pill" type="button">Details</button>
              <button id="libraryJumpBrowseBtn" class="pill rg-library-jump-pill" type="button">Browse</button>
            </div>

            <div id="libraryNotationPlaceholder" aria-label="Library notation placeholder">
              <div id="libraryNotLoadedNotice" class="rg-library-notice hidden">
                <div class="rg-muted rg-library-notice-title">No CCCBR library loaded yet.</div>
                <div class="rg-library-notice-actions">
                  <button id="libraryGoSetupBtn" class="pill" type="button">Go to Setup</button>
                </div>
                <div class="rg-library-notice-links">
                  <a href="https://methods.cccbr.org.uk/xml/CCCBR_methods.xml.zip" target="_blank" rel="noopener">CCCBR methods library (download ZIP)</a>
                </div>
              </div>

              <div id="libraryLayout" class="rg-library-layout">
                <div class="rg-library-col rg-library-browse" aria-label="Browse">
                  <div id="libraryBrowseAnchor" class="rg-library-anchor" aria-hidden="true"></div>
                  <div class="rg-library-col-head">
                    <div class="rg-library-col-title">Browse</div>
                    <input id="librarySearchInput" type="search" placeholder="Search open groups…" autocomplete="off" />
                  </div>
                  <div id="libraryBrowseGroups" class="rg-library-groups"></div>
                </div>

                <div class="rg-library-col rg-library-details" aria-label="Details">
                  <div id="libraryDetailsAnchor" class="rg-library-anchor" aria-hidden="true"></div>
                  <div id="libraryDetailsEmpty" class="rg-muted">Select a method to see details.</div>
                  <div id="libraryDetailsPanel" class="hidden">
                    <div id="librarySelectedTitle" class="rg-library-selected-title"></div>
                    <div id="librarySelectedMeta" class="rg-library-selected-meta"></div>
                    <div id="libraryGlossary" class="rg-library-section"></div>
                    <div id="libraryClassGlossary" class="rg-library-section"></div>
                    <div id="libraryNotes" class="rg-library-section"></div>

                    <div class="rg-library-actions">
                      <button id="libraryPlaySelectedBtn" class="pill" type="button" disabled>Play</button>
                      <button id="libraryDemoSelectedBtn" class="pill" type="button" disabled>Demo</button>
                    </div>

                    <div class="rg-library-preview">
                      <div class="rg-library-preview-head">
                        <div class="rg-library-col-title">Preview</div>
                        <div class="rg-library-line">
                          <label for="libraryLineBellSelect" class="rg-muted">Line bell</label>
                          <select id="libraryLineBellSelect"></select>
                        </div>
                      </div>
                      <div class="rg-library-preview-box">
                        <pre id="libraryPreview" class="rg-library-preview-pre"></pre>
                        <button id="libraryPreviewPrevBtn" class="pill rg-library-page-nav" type="button" aria-label="Previous pages">&lt;</button>
                        <div id="libraryPreviewPageLabel" class="rg-library-preview-page-label rg-muted" aria-live="polite"></div>
                        <button id="libraryPreviewNextBtn" class="pill rg-library-page-nav" type="button" aria-label="Next pages">&gt;</button>
                      </div>
                      <div id="libraryPreviewLimitNote" class="rg-library-preview-limit rg-muted hidden">Preview limit reached.</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="rg-nav">
              <button class="pill" type="button" data-go-screen="play">Setup</button>
              <button class="pill" type="button" data-go-screen="view">View</button>
              <button class="pill" type="button" data-go-screen="sound">Sound</button>
              <button id="libraryBtnEnterGame" class="pill" type="button">Play</button>
              <button id="libraryBtnDemo" class="pill" type="button">Demo</button>
            </div>
          </div>
        </section>
      </div>

      <div id="screenGame" class="rg-screen" aria-hidden="true">

      <div id="countOverlay" class="count-overlay" aria-hidden="true"></div>
      <header class="top-bar">
        <div class="rg-game-head">
          <h1>Ringer Game</h1>
          <div class="rg-game-meta" aria-label="Method and tempo">
            <div class="rg-game-meta-line">
              <span id="gameMetaMethod"></span>
              <span id="gameMetaSource" class="rg-muted"></span>
            </div>
            <div class="rg-game-meta-line">
              <span id="gameMetaAttr" class="rg-muted hidden"></span>
              <span id="gameMetaBpm" class="rg-muted"></span>
            </div>
          </div>
        </div>
        <div id="controls">
          <div class="control">
            <label for="methodSelect">Method</label>
            <select id="methodSelect">
              <option value="plainhunt">Plain Hunt</option>
              <option value="plainbob">Plain Bob (variation)</option>
              <option value="grandsire">Grandsire (variation)</option>
              <option value="custom">Custom (TXT/XML file)</option>
            </select>
          </div>

          <div class="control">
            <label for="bellCount" title="Stage = number of bells (4–12).">Bells (stage)</label>
            <select id="bellCount">
              <option value="4">4 (Minimus)</option>
              <option value="5">5 (Doubles)</option>
              <option value="6" selected>6 (Minor)</option>
              <option value="7">7 (Triples)</option>
              <option value="8">8 (Major)</option>
              <option value="9">9 (Caters)</option>
              <option value="10">10 (Royal)</option>
              <option value="11">11 (Cinques)</option>
              <option value="12">12 (Maximus)</option>
            </select>
          </div>

          <div class="control">
            <label for="scaleSelect" title="Musical key used to tune bells (or choose Custom (Hz)).">Bell key</label>
            <select id="scaleSelect"></select>
          </div>

          <div class="control">
            <label for="octaveSelect" title="C-octave register used for tuning (C1–C6).">Register (C octave)</label>
            <select id="octaveSelect"></select>
          </div>

          <div class="control">
            <label for="bellCustomHzInput">Bell root (Hz)</label>
            <input id="bellCustomHzInput" type="number" min="20" max="4000" step="0.01" value="440" />
            <input id="bellCustomHzSlider" type="range" min="20" max="4000" step="1" value="440" aria-label="Bell root Hz slider" />
          </div>

          <div class="control">
            <label for="bellVolume">Bell volume</label>
            <input id="bellVolume" type="range" min="0" max="100" value="100" />
          </div>

          <div class="control">
            <label>Drone</label>
            <button id="droneOnOffBtn" class="pill" type="button">Drone On</button>
          </div>

          <div class="control">
            <label for="droneTypeSelect">Drone type</label>
            <select id="droneTypeSelect">
              <option value="single" selected>Single tone</option>
              <option value="octaves">Octaves (low–mid–high)</option>
              <option value="root5">Root + 5th</option>
              <option value="fifth">Root + 5th + octave</option>
              <option value="majtriad">Major triad (1–3–5)</option>
              <option value="mintriad">Minor triad (1–♭3–5)</option>
              <option value="seventh">Major 7 (1–3–5–7)</option>
              <option value="harm4">Harmonic stack (1–4)</option>
              <option value="harm6">Harmonic stack (1–6)</option>
              <option value="oddharm">Odd harmonics (1,3,5,7)</option>
              <option value="shepard">Octave cloud (Shepard-like)</option>
              <option value="cluster">Semitone cluster (±3)</option>
              <option value="noise">Noise drone (tone-aware)</option>
              <option value="resnoise">Resonant noise</option>
              <option value="noisetone">Noise + gentle tone</option>
            </select>
          </div>

          <!-- v014_p02_drone_variant_knobs: Drone Variants -->
          <div class="control" id="droneVariantsControl">
            <label>Variants</label>
            <div id="droneVariantsAnchor" class="hidden"></div>
            <div class="rg-controls rg-variants-controls" aria-label="Drone variants">
              <div class="control">
                <label>Normalize loudness</label>
                <button id="droneNormalizeBtn" class="pill active" type="button" aria-pressed="true">On</button>
              </div>

              <div class="control">
                <label for="droneDensity">Density</label>
                <input id="droneDensity" type="range" min="1" max="12" step="1" value="3" />
              </div>

              <div class="control">
                <label for="droneDriftCents">Drift (cents)</label>
                <input id="droneDriftCents" type="range" min="0" max="20" step="1" value="0" />
              </div>

              <div class="control hidden" id="droneVariantMotionControl">
                <label for="droneMotionRate">Motion rate</label>
                <input id="droneMotionRate" type="range" min="0" max="10" step="0.1" value="0" />
              </div>

              <div class="control hidden" id="droneVariantClusterControl">
                <label for="droneClusterWidth">Cluster width</label>
                <select id="droneClusterWidth">
                  <option value="1">±1 semitone</option>
                  <option value="2">±2 semitones</option>
                  <option value="3" selected>±3 semitones</option>
                  <option value="5">±5 semitones</option>
                </select>
              </div>

              <div class="control hidden" id="droneVariantNoiseTiltControl">
                <label for="droneNoiseTilt">Noise tilt</label>
                <input id="droneNoiseTilt" type="range" min="-1" max="1" step="0.01" value="0" />
              </div>

              <div class="control hidden" id="droneVariantNoiseQControl">
                <label for="droneNoiseQ">Resonance (Q)</label>
                <input id="droneNoiseQ" type="range" min="0.5" max="10" step="0.1" value="1" />
              </div>
            </div>
          </div>


          <div class="control">
            <label for="droneScaleSelect" title="Musical key used to tune the drone (or choose Custom (Hz)).">Drone key</label>
            <select id="droneScaleSelect"></select>
          </div>

          <div class="control">
            <label for="droneOctaveSelect" title="C-octave register used for the drone (C1–C6).">Drone register</label>
            <select id="droneOctaveSelect"></select>
          </div>

          <div class="control">
            <label for="droneCustomHzInput">Drone root (Hz)</label>
            <input id="droneCustomHzInput" type="number" min="20" max="4000" step="0.01" value="440" />
            <input id="droneCustomHzSlider" type="range" min="20" max="4000" step="1" value="440" aria-label="Drone root Hz slider" />
          </div>

          <div class="control">
            <label for="droneVolume">Drone volume</label>
            <input id="droneVolume" type="range" min="0" max="100" value="50" />
          </div>

          <div class="control">
            <label for="liveCount">Scored bells</label>
            <select id="liveCount"></select>
          </div>

          <div class="control">
            <label>Pick scored bells</label>
            <div id="bellPicker" class="bell-picker" aria-label="Pick scored bells"></div>
          </div>

          <div class="control">
            <label>Glyph- / Key Bindings</label>
            <div id="keybindPanel" class="keybind-panel" aria-label="Glyph- / Key Bindings"></div>
            <div class="keybind-actions">
              <button id="keybindResetBtn" class="pill" type="button">Reset to defaults</button>
            </div>
            <div id="keybindNote" class="keybind-note"></div>
          </div>

          <div class="control">
            <label for="bpmInput">Tempo (BPM)</label>
            <div class="path-row rg-tempo-row" aria-label="Tempo controls">
              <input id="bpmInput" type="number" min="1" max="240" value="120" />
              <button id="bpmTapBtn" class="pill" type="button">Tap</button>
            </div>
            <input id="bpmSlider" type="range" min="1" max="240" step="1" value="120" aria-label="Tempo slider" />
          </div>

          <div class="control mic-control">
            <label>Mic</label>
            <div class="path-row">
              <button id="micToggleBtn" class="pill" type="button" aria-pressed="false">Mic OFF</button>
              <button id="micCalibrateBtn" class="pill" type="button">Calibrate</button>
              <span id="micCalibrateStatus" class="mic-status"></span>
              <span id="micStatus" class="mic-status"></span>
            </div>
          </div>

          <div class="control">
            <label for="micCooldown">Mic cooldown (ms)</label>
            <input id="micCooldown" type="range" min="100" max="400" step="10" value="200" />
            <div id="micCooldownVal" class="mic-status"></div>
          </div>

          <div class="control view-control">
            <label>View</label>
            <div class="toggles" role="group" aria-label="View toggles">
              <label class="toggle"><input id="viewDisplay" type="checkbox" checked /> Display</label>
              <label class="toggle"><input id="viewSpotlight" type="checkbox" checked /> Spotlight</label>
              <label class="toggle"><input id="viewNotation" type="checkbox" checked /> Notation</label>
              <label class="toggle"><input id="viewStats" type="checkbox" checked /> Stats</label>
              <label class="toggle"><input id="viewMic" type="checkbox" /> Mic</label>
            </div>
          </div>

          <div class="control">
            <label>Overlays</label>
            <div class="toggles toggles--mini" role="group" aria-label="Accuracy dots toggles">
              <label class="toggle"><input id="accuracyDotsEnabled" type="checkbox" checked /> Accuracy dots</label>
              <div class="toggles toggles--mini toggles--indent" role="group" aria-label="Accuracy dots per-pane toggles">
                <label class="toggle"><input id="accuracyDotsDisplay" type="checkbox" checked /> Display</label>
                <label class="toggle"><input id="accuracyDotsNotation" type="checkbox" checked /> Notation</label>
                <label class="toggle"><input id="accuracyDotsSpotlight" type="checkbox" checked /> Spotlight</label>
              </div>
            </div>
          </div>

         
          <div class="control">
            <label>Display</label>
            <div class="toggles toggles--mini" role="group" aria-label="Display toggles">
              <label class="toggle"><input id="displayLiveOnly" type="checkbox" /> Display scored bell(s) only</label>
            </div>
          </div>

          <div class="control">
            <label>Spotlight swaps</label>
            <div class="toggles toggles--mini" role="group" aria-label="Spotlight swaps toggles">
              <label class="toggle"><input id="spotlightSwapsView" type="checkbox" /> Swaps view</label>
              <span id="spotlightSwapRows" class="toggles toggles--mini hidden" role="group" aria-label="Spotlight swap rows">
                <label class="toggle"><input id="spotlightShowN" type="checkbox" /> N</label>
                <label class="toggle"><input id="spotlightShowN1" type="checkbox" /> N+1</label>
                <label class="toggle"><input id="spotlightShowN2" type="checkbox" /> N+2</label>
              </span>
            </div>
          </div>

          <div class="control">
            <label>Notation swaps</label>
            <div class="toggles toggles--mini" role="group" aria-label="Notation swaps toggles">
              <label class="toggle"><input id="notationSwapsOverlay" type="checkbox" /> Notation swaps overlay</label>
            </div>
          </div>

          <div class="control path-control">
            <label>Line (blue line)</label>
            <div class="path-row">
              <button id="pathNoneBtn" class="pill active" type="button">None</button>
              <button id="pathAllBtn" class="pill" type="button">All</button>
              <div id="pathPicker" class="bell-picker bell-picker--small" aria-label="Line (blue line) bells"></div>
            </div>
          </div>

          <div class="control">
            <label for="fileInput">Method file (TXT/XML)</label>
            <input id="fileInput" type="file" accept=".txt,.xml" />
          </div>

          <div class="control rg-file-input-offscreen">
            <label for="xmlInput">CCCBR XML / ZIP</label>
            <input id="xmlInput" type="file" accept=".xml,.zip" multiple />
          </div>

          <div class="control control-buttons">
            <button id="startBtn">Start</button>
            <button id="pauseBtn" disabled>Pause</button>
            <button id="stopBtn" disabled>Stop</button>
            <button id="demoBtn">Demo</button>
            <button id="dronePauseBtn" class="hidden" disabled>Pause Drone</button>
          </div>
        </div>
      </header>


      <div id="rgMenuOverlay" class="hidden" aria-hidden="true">
        <div id="rgMenuPanel" class="pane" role="dialog" aria-modal="true" aria-label="Menu">
          <div class="rg-menu-head">
            <div class="pane-title"><span>Menu</span></div>
            <button id="rgMenuClose" type="button">Close</button>
          </div>
          <div class="rg-menu-buttons">
            <button id="rgMenuGoPlay" type="button">Setup</button>
            <button id="rgMenuGoView" type="button">View</button>
            <button id="rgMenuGoSound" type="button">Sound</button>
          </div>
        </div>
      </div>

      <main id="main" class="main">
        <div id="leftStack">
          <section id="displayPane" class="pane">
            <div class="pane-title"><span>Display</span></div>
            <canvas id="displayCanvas" aria-label="Display"></canvas>
          </section>

          <section id="spotlightPane" class="pane">
            <div class="pane-title"><span>Spotlight</span></div>
            <canvas id="spotlightCanvas" aria-label="Spotlight"></canvas>
          </section>

          <section id="micPane" class="pane hidden">
            <div class="pane-title"><span>Mic</span></div>
            <div class="mic-body">
              <div class="mic-meter" aria-label="Mic level meter"><div id="micMeterFill" class="mic-meter-fill"></div></div>
              <div class="mic-readouts">
                <div><span class="mic-label">Level</span><span id="micDbReadout">–∞ dB</span></div>
                <div id="micPaneStatus" class="mic-status"></div>
              </div>
            </div>
          </section>
        </div>

        <section id="notationPane" class="pane">
          <div class="pane-title"><span>Notation</span></div>
          <div class="notation-wrap">
            <canvas id="notationCanvas" aria-label="Notation"></canvas>
            <button id="notationPrevBtn" class="pill notation-page-nav hidden" type="button" aria-label="Previous notation pages">&lt;</button>
            <button id="notationNextBtn" class="pill notation-page-nav hidden" type="button" aria-label="Next notation pages">&gt;</button>
          </div>
        </section>

        <section id="statsPane" class="pane pane-span">
          <div class="pane-title">
            <span>Stats</span>
          </div>
          <div id="statsContent">
            <div id="stats"></div>
          </div>
        </section>

        <section id="methodLibrary" class="pane pane-span hidden">
          <div class="pane-title">
            <span>Method Library</span>
          </div>
          <div id="methodList"
               style="padding:12px;display:flex;flex-wrap:wrap;gap:8px;">
          </div>
        </section>
      </main>

      <footer class="footer">
        <p id="hint">Keys 1–9 (and 0/E/T for 10/11/12) ring bells by default. Use Keybindings to rebind scored bells (and Space/Enter when you have a single scored bell). Tap/click bells in the Display. Non-scored bells are rung by bots. Only your selected scored bells count toward your score.</p>
      </footer>
    
      </div>
</div>


  <footer class="rg-footer-privacy" aria-label="Privacy">
    <button id="footerPrivacyLink" class="rg-footer-privacy-link" type="button">Privacy</button>
  </footer>

    <div id="rgConsentBanner" class="rg-consent-banner hidden" aria-hidden="true" role="region" aria-label="Privacy and analytics consent">
      <div class="rg-consent-inner">
        <div class="rg-consent-text">
          
          <div class="rg-consent-copy">
            <div class="rg-consent-head"><strong>Ringer Game does not track you or create user profiles.</strong></div>
            <div class="rg-consent-body">With your permission, it can measure overall site visits (audience measurement).</div>
          </div>
          <button id="rgConsentPrivacyLink" class="rg-link-button" type="button">Privacy</button>
        </div>
        <div class="rg-consent-actions">
          <button id="rgConsentAllow" class="pill rg-consent-btn" type="button">Allow audience measurement</button>
          <button id="rgConsentDeny" class="pill rg-consent-btn" type="button">Essential only</button>
        </div>
      </div>
    </div>

<script src="./app.js"></script>
  </body>
</html>
